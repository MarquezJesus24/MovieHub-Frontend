<div class="catalog-container">
  
  <header class="catalog-header">
    <h1>üé¨ Cat√°logo de Pel√≠culas</h1>
    <p class="subtitle">Descubre las mejores pel√≠culas</p>
  </header>


  <div class="toolbar">
    
    <div class="search-container">
  
      <input 
        type="text" 
        class="search-input"
        placeholder="Buscar pel√≠culas..."
        [value]="searchTerm()"
        (input)="onSearchChange($any($event.target).value)"
      >
      
      @if (searchTerm()) {
        <button 
          class="btn-clear"
          (click)="onSearchChange('')"
        >
          ‚úñ
        </button>
      }
    </div>

    <div class="sort-container">
      <label>Ordenar por:</label>
      
      <select 
        [value]="sortBy()"
        (change)="onSortChange($any($event.target).value)"
        class="sort-select"
      >
        <option value="rating">Calificaci√≥n</option>
        <option value="fechaCreacion">Fecha</option>
        <option value="nombre">Nombre</option>
      </select>
    </div>

    <button 
      class="btn-refresh"
      (click)="loadMovies()"
      [disabled]="loading()"
    >
      üîÑ Actualizar
    </button>

  </div>

  @if (loading()) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Cargando pel√≠culas...</p>
    </div>
  }

  @if (error() && !loading()) {
    <div class="error-container">
      <p class="error-message">{{ error() }}</p>
      <button class="btn-retry" (click)="loadMovies()">
        Reintentar
      </button>
    </div>
  }

  @if (!loading() && !error()) {
    <div class="movies-grid">
      @for (movie of filteredMovies(); track movie.id) {
        <div class="movie-card">
          <div class="movie-image-container">
            <img 
              [src]="movie.posterPath" 
              [alt]="movie.name"
              class="movie-image"
              loading="lazy"
            >
            <div class="badge-rating">
              ‚≠ê {{ movie.rating.toFixed(1) }}
            </div>
          </div>

          <div class="movie-content">
            <h3 class="movie-title" [title]="movie.name">
              {{ movie.name }}
            </h3>
            <p class="movie-description">
              {{ movie.description.substring(0, 100) }}
              @if (movie.description.length > 100) {
                <span>...</span>
              }
            </p>
            <div class="movie-footer">
              <span class="movie-date">
                üìÖ {{ movie.createAt | date:'dd/MM/yyyy' }}
              </span>
              <button 
                class="btn-details"
                [routerLink]="['/movie', movie.id]"
              >
                Ver M√°s ‚Üí
              </button>
            </div>
          </div>
        </div>
        
      } @empty {
        <div class="no-results">
          <p class="no-results-icon">üîç</p>
          <p class="no-results-text">
            No se encontraron pel√≠culas
            @if (searchTerm()) {
              <span> para "{{ searchTerm() }}"</span>
            }
          </p>
          <button 
            class="btn-clear-search" 
            (click)="onSearchChange('')"
          >
            Limpiar b√∫squeda
          </button>
        </div>
      }
    </div>

    <div class="catalog-info">
      <p>
        Mostrando {{ filteredMovies().length }} 
        de {{ movies().length }} pel√≠culas
      </p>
    </div>
  }
</div>